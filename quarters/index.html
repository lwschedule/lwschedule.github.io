<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quarters - LW Schedule</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="/icons/icon-192.png">
  <link rel="apple-touch-icon" href="/icons/icon-512.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#4b2e83">
  <link rel="stylesheet" href="/common.css">
  <style>
    .academic-term-list { display: flex; flex-direction: column; gap: 15px; }
    .term-card { background: #1f1f1f; border-radius: 12px; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; transition: all 0.3s ease; }
    .term-card.highlight { background: linear-gradient(135deg, var(--primary), var(--primary-light), var(--primary)) !important; background-size: 200% 200% !important; animation: gradientShift5 8s ease infinite !important; color: white; box-shadow: var(--glow); }
    .term-info { flex: 1; min-width: 150px; }
    .term-name { font-size: 1.2em; font-weight: 700; margin-bottom: 5px; }
    .term-dates { font-size: 0.9em; opacity: 0.8; }
    .term-card.highlight .term-dates { opacity: 0.9; }
    .term-countdown { flex-shrink: 0; }
    .term-countdown-block { text-align: right; }
    .term-countdown-block .countdown-value { font-size: clamp(1.5em, 5vw, 2em); font-weight: 700; color: var(--primary-light); line-height: 1.1; }
    .term-countdown-block .countdown-label { font-size: 0.7em; font-weight: 400; color: var(--text-light); opacity: 0.7; letter-spacing: 0.1em; text-transform: uppercase; margin-top: 2px; }
    .term-card.highlight .countdown-value { color: white; }
    .term-card.highlight .countdown-label { color: white; opacity: 0.9; }
    .term-completed-badge { background: linear-gradient(135deg, var(--primary), var(--primary-light), var(--primary)); background-size: 200% 200%; animation: gradientShift4 8s ease infinite; color: white; opacity: 0.8; padding: 8px 15px; border-radius: 20px; font-size: 0.9em; font-weight: 700; }
    @keyframes gradientShift4 { 0% { background-position: 25% 75%; } 40% { background-position: 75% 25%; } 80% { background-position: 0% 100%; } 100% { background-position: 25% 75%; } }
  </style>
</head>
<body>
  <a href="/" class="backBtn">← Back</a>
  <div class="pageContainer">
    <h2>Quarters & Semesters</h2>
    <h3 style="color: white; margin-top: 20px; margin-bottom: 10px;">Quarters 2025-26</h3>
    <div id="quartersList" class="academic-term-list">
      <p>Loading quarters...</p>
    </div>
    <h3 style="color: white; margin-top: 30px; margin-bottom: 10px;">Semesters 2025-26</h3>
    <div id="semestersList" class="academic-term-list">
      <p>Loading semesters...</p>
    </div>
  </div>
  <script src="/common.js"></script>
  <script>
    let quartersInterval = null;
    function formatTermDate(date) {
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }
    function getCountdownHTML(now, start, end) {
      const nowTime = now.getTime();
      const startTime = start.getTime();
      const endTime = end.getTime();
      if (nowTime > endTime) return `<div class="term-completed-badge">Completed</div>`;
      let diff, label;
      if (nowTime < startTime) { diff = startTime - nowTime; label = "Starts in"; }
      else { diff = endTime - nowTime; label = "Ends in"; }
      const totalSeconds = Math.floor(diff / 1000);
      const totalMinutes = Math.floor(totalSeconds / 60);
      const totalHours = Math.floor(totalMinutes / 60);
      const totalDays = Math.floor(totalHours / 24);
      let value, unit;
      if (totalDays > 0) { value = totalDays; unit = totalDays === 1 ? "Day" : "Days"; }
      else if (totalHours > 0) { value = totalHours; unit = totalHours === 1 ? "Hour" : "Hours"; }
      else if (totalMinutes > 0) { value = totalMinutes; unit = totalMinutes === 1 ? "Minute" : "Minutes"; }
      else { value = totalSeconds; unit = totalSeconds === 1 ? "Second" : "Seconds"; }
      return `<div class="term-countdown-block"><span class="countdown-label">${label}</span><span class="countdown-value">${value} ${unit}</span></div>`;
    }
    function updateQuartersAndSemesters() {
      const now = new Date();
      const quartersListEl = document.getElementById('quartersList');
      const semestersListEl = document.getElementById('semestersList');
      if (!quartersListEl || !semestersListEl) {
        if (quartersInterval) { clearInterval(quartersInterval); quartersInterval = null; }
        return;
      }
      let quartersHTML = '';
      academicTerms.quarters.forEach(term => {
        const isActive = now >= term.start && now <= term.end;
        quartersHTML += `<div class="term-card ${isActive ? 'highlight' : ''}"><div class="term-info"><div class="term-name">${term.name}</div><div class="term-dates">${formatTermDate(term.start)} — ${formatTermDate(term.end)}</div></div><div class="term-countdown">${getCountdownHTML(now, term.start, term.end)}</div></div>`;
      });
      let semestersHTML = '';
      academicTerms.semesters.forEach(term => {
        const isActive = now >= term.start && now <= term.end;
        semestersHTML += `<div class="term-card ${isActive ? 'highlight' : ''}"><div class="term-info"><div class="term-name">${term.name}</div><div class="term-dates">${formatTermDate(term.start)} — ${formatTermDate(term.end)}</div></div><div class="term-countdown">${getCountdownHTML(now, term.start, term.end)}</div></div>`;
      });
      quartersListEl.innerHTML = quartersHTML;
      semestersListEl.innerHTML = semestersHTML;
    }
    (async () => {
      await initApp();
      updateQuartersAndSemesters();
      if (quartersInterval) clearInterval(quartersInterval);
      quartersInterval = setInterval(updateQuartersAndSemesters, 1000);
    })();
  </script>
</body>
</html>
