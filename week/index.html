<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Week's Schedule - LW Schedule</title>
  <link rel="stylesheet" href="/common.css">
  <script src="/common.js"></script>

</head>
<body>
  <a href="/" class="backBtn">‚Üê Back</a>
  <div class="pageContainer">
    <h2>This Week's Schedule</h2>
    <div id="weekContent">
      <p>Loading this week's schedule...</p>
    </div>
  </div>
  <script>
function getScheduleSummary(schedules, dayName) {
const schedule = schedules[dayName];
if (!schedule || schedule.length === 0) return 'No School';
let names = schedule.map(p => p.name);
names = names.filter(n => n !== "Break" && n !== "Period 4 (Part 2)");
const simplifiedNames = names.map(n => {
if (n.startsWith("Period 1")) return "1";
if (n.startsWith("Period 2")) return "2";
if (n.startsWith("Period 3")) return "3";
if (n.startsWith("Period 4")) return "4";
if (n.startsWith("Period 5")) return "5";
if (n.startsWith("Period 6")) return "6";
if (n.includes("Lunch")) return "L";
if (n.includes("Homeroom")) return "HR";
return n;
});
const uniqueNames = [...new Set(simplifiedNames)];
return uniqueNames.join(',');
}
function updateWeekSchedule() {
const scheduleEl = document.getElementById('weekContent');
if (!scheduleEl) return;
let html = `<table class="weekTable"><thead><tr><th>Day</th><th>Schedule</th></tr></thead><tbody>`;
const now = new Date();
let currentDayOfWeek = now.getDay();
const monday = new Date(now);
let diff = currentDayOfWeek === 0 ? -6 : 1 - currentDayOfWeek;
if (currentDayOfWeek === 6 || currentDayOfWeek === 0) {
diff += 7;
} else {
const thisFriday = new Date(now);
thisFriday.setDate(now.getDate() + (5 - currentDayOfWeek));
const fridayHoliday = getHolidayForDate(thisFriday);
if (fridayHoliday) {
diff += 7;
}
}
monday.setDate(now.getDate() + diff);
const weekDays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
const todayName = currentDayName();
for (let i = 0; i < 5; i++) {
const dayDate = new Date(monday);
dayDate.setDate(monday.getDate() + i);
const dayNameStr = weekDays[i];
const isToday = (dayNameStr === todayName && dayDate.toDateString() === now.toDateString());
const holidayName = getHolidayForDate(dayDate);
let summary = '';
if (holidayName) {
summary = holidayName;
} else {
const schedules = getSchedules(dayDate);
summary = getScheduleSummary(schedules, dayNameStr);
}
html += `<tr class="${isToday ? 'highlight' : ''} clickable-row" data-day="${dayNameStr.toLowerCase()}" data-date="${dayDate.toISOString()}"><td>${dayNameStr}</td><td>${summary}</td></tr>`;
}
html += '</tbody></table>';
scheduleEl.innerHTML = html;
document.querySelectorAll('.clickable-row').forEach(row => {
row.addEventListener('click', () => {
const day = row.dataset.day;
const date = row.dataset.date;
window.location.href = `/week/${day}?date=${encodeURIComponent(date)}`;
});
});
}
checkSetupComplete();
loadLunchPreferences();
loadThemeOnPage();
updateWeekSchedule();
</script>
</body>
</html>
