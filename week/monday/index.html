<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monday - LW Schedule</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="/images/logo.png">
  <link rel="apple-touch-icon" href="/icons/icon-512.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#4b2e83">
  <link rel="stylesheet" href="/common.css">
</head>
<body>
  <a href="/week" class="backBtn">‚Üê Back</a>
  <div class="pageContainer">
    <h2 id="dayTitle">Monday's Schedule</h2>
    <div id="dayContent">
      <p>Loading schedule...</p>
    </div>
  </div>
  <script src="/common.js"></script>
  <script>
    (async () => {
      await initApp();
      const scheduleEl = document.getElementById('dayContent');
      if (!scheduleEl) return;

      const path = window.location.pathname;
      const dayMatch = path.match(/\/week\/(\w+)/);
      if (!dayMatch) return;
      const dayName = dayMatch[1].charAt(0).toUpperCase() + dayMatch[1].slice(1);

      const urlParams = new URLSearchParams(window.location.search);
      const dateParam = urlParams.get('date');
      let dayDate;
      if (dateParam) {
        dayDate = new Date(dateParam);
      } else {
        // Calculate the date for the current week's day
        const now = new Date();
        const currentDayOfWeek = now.getDay();
        let diff = currentDayOfWeek === 0 ? -6 : 1 - currentDayOfWeek;
        if (currentDayOfWeek === 6 || currentDayOfWeek === 0) {
          diff += 7;
        } else {
          const thisFriday = new Date(now);
          thisFriday.setDate(now.getDate() + (5 - currentDayOfWeek));
          const fridayHoliday = getHolidayForDate(thisFriday);
          if (fridayHoliday) {
            diff += 7;
          }
        }
        const monday = new Date(now);
        monday.setDate(now.getDate() + diff);
        const weekDays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
        const dayIndex = weekDays.indexOf(dayName);
        if (dayIndex === -1) return;
        dayDate = new Date(monday);
        dayDate.setDate(monday.getDate() + dayIndex);
      }

      const holidayName = getHolidayForDate(dayDate);
      if (holidayName) {
        scheduleEl.innerHTML = `<div class="noSchoolMessage"><h3>${holidayName}</h3><p>No school today!</p></div>`;
        return;
      }

      const schedules = getSchedules(dayDate);
      const schedule = schedules[dayName];
      scheduleEl.innerHTML = renderScheduleTable(schedule, null, true);
    })();
  </script>
</body>
</html>
